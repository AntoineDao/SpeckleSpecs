# Users and clients
User:
  $ref: ./User.yaml
SpeckleClient: 
  $ref: ./Client.yaml

# Streams and their components
DataStream:
  $ref: ./DataStream.yaml
SpeckleLayer:
  $ref: ./SpeckleLayer.yaml
SpeckleLayerProperties:
  $ref: ./SpeckleLayerProperties.yaml

# Payloads
PayloadAccountRegister:
  $ref: ./payloads/PayloadAccountRegister.yaml
PayloadAccountLogin: 
  $ref: ./payloads/PayloadAccountLogin.yaml
PayloadClientCreate:
  $ref: ./payloads/PayloadClientCreate.yaml
PayloadClientUpdate:
  $ref: ./payloads/PayloadClientUpdate.yaml
PayloadStreamUpdate:
  $ref: ./payloads/PayloadStreamUpdate.yaml
PayloadStreamMetaUpdate:
  $ref: ./payloads/PayloadStreamMetaUpdate.yaml
PayloadStreamLayersUpdate:
  $ref: ./payloads/PayloadStreamLayersUpdate.yaml
PayloadStreamNameUpdate:
  $ref: ./payloads/PayloadStreamNameUpdate.yaml
PayloadCreateObject:
  $ref: ./payloads/PayloadObjectCreate.yaml
PayloadObjectUpdate:
  $ref: ./payloads/PayloadObjectUpdate.yaml
PayloadObjectCreateWithArray:
  $ref: ./payloads/PayloadObjectCreateWithArray.yaml

# Responses TODO: Unify on server too
ResponseBase:
  type: object
  properties: 
    success: 
      type: boolean
      description: Besides the http status code, this tells you whether the call succeeded or not.
    message: 
      type: string
      description: Either an error or a confirmation.

# Responses Accounts
ResponseAccountRegister: 
  $ref: ./responses/ResponseAccountRegister.yaml
ResponseAccountLogin: 
  $ref: ./responses/ResponseAccountLogin.yaml
ResponseAccountStreams:
  $ref: ./responses/ResponseAccountStreams.yaml
ResponseAccountClients:
  $ref: ./responses/ResponseAccountClients.yaml
ResponseAccountProfile:
  $ref: ./responses/ResponseAccountProfile.yaml

# Responses Clients
ResponseClientCreate:
  $ref: ./responses/ResponseClientCreate.yaml
ResponseClientGet:
  $ref: ./responses/ResponseClientGet.yaml
  
# Responses Streams
ResponseStreamCreate:
  $ref: ./responses/ResponseStreamCreate.yaml
ResponseStreamGet:
  $ref: ./responses/ResponseStreamGet.yaml
ResponseStreamMetaGet:
  $ref: ./responses/ResponseStreamMetaGet.yaml
ResponseStreamLayersGet:
  $ref: ./responses/ResponseStreamLayersGet.yaml
ResponseStreamNameGet:
  $ref: ./responses/ResponseStreamNameGet.yaml
ResponseStreamUpdate:
  $ref: ./responses/ResponseStreamUpdate.yaml
ResponseStreamUpdate:
  $ref: ./responses/ResponseStreamUpdate.yaml
ResponseStreamDuplicate:
  $ref: ./responses/ResponseStreamDuplicate.yaml

# Responses Objects
ResponseObjectCreate:
  $ref: ./responses/ResponseObjectCreate.yaml 
ResponseObjectGet:
  $ref: ./responses/ResponseObjectGet.yaml 
ResponseObjectUpdate:
  $ref: ./responses/ResponseObjectUpdate.yaml 
ResponseObjectWithArrayCreate:
  $ref: ./responses/ResponseObjectWithArrayCreate.yaml 
ResponseObjectWithArrayGet:
  $ref: ./responses/ResponseObjectWithArrayGet.yaml 
ResponseObjectWithArrayUpdate:
  $ref: ./responses/ResponseObjectWithArrayUpdate.yaml 

# Objects
SpeckleObject:
  type: object
  required:
    - type
  discriminator: type
  properties:
    type:
      type: string
      description: object's type
      enum:
        - Boolean
        - Number
        - String
        - Interval
        - Interval2d
        - Point
        - Vector
        - Plane
        - Line
        - Rectangle
        - Circle
        - Box
        - Polyline
        - Curve
        - Mesh
        - Brep
        - 'Null'
    hash:
      type: string
      description: Object's unique hash. It's generated server-side from JSON.stringify( obj.properties ) + obj.geometryHash using a murmurhash3 128bit function.
    geometryHash:
      type: string
      description: 'It the object contains geometry, it should have a geometry hash.'
      example: Polyline.b8cabb148761a918b22128c8f05b1d47
    applicationId:
      type: string
      description: 'If this object is not an ephemeral object, (ie coming from Grasshopper or Dynamo), and has a unique, persistent and consistent application id, this is where to store said guid.'
    properties:
      type: object
      description: 'Anything goes in here, including other objects.'
      example: '{ objectIsSad: false, bimLevel: "infinity", nestedTurtle: { ... }}'
  description: Minimal representation of a SpeckleObject. Contains other values depending on specific class. See the .net docs for more info.
SpeckleBoolean:
  allOf: 
    - $ref: '#/definitions/SpeckleObject'
    - type: object
      properties:
        type:
          default: Boolean
        value:
          type: boolean
SpeckleNumber:
  allOf: 
    - $ref: '#/definitions/SpeckleObject'
    - type: object
      properties:
        type:
          default: Number
        value:
          type: number         
SpeckleString:
  allOf: 
    - $ref: '#/definitions/SpeckleObject'
    - type: object
      properties:
        type:
          default: String
        value:
          type: string
SpeckleInterval: 
  allOf: 
    - $ref: '#/definitions/SpeckleObject'
    - type: object
      properties:
        type:
          default: Interval
        start:
          type: number
        end: 
          type: number
SpeckleInterval2d: 
  allOf: 
    - $ref: '#/definitions/SpeckleObject'
    - type: object
      properties:
        U:
          allOf: 
            - $ref: '#/definitions/SpeckleInterval'
        V:
          allOf: 
            - $ref: '#/definitions/SpeckleInterval'
SpecklePoint:
  allOf: 
    - $ref: '#/definitions/SpeckleObject'
    - type: object
      properties:
        type:
          default: Point
        value:
          description: An array containing the XYZ coords of the point.
          type: array
          items:
            type: number
SpeckleVector: 
  allOf: 
    - $ref: '#/definitions/SpeckleObject'
    - type: object
      properties:
        type: 
          default: Vector
        value:
          description: An array containing the XYZ coords of the vector.
          type: array
          items: 
            type: number
SpecklePlane:
  allOf:
    - $ref: '#/definitions/SpeckleObject'
    - type: object
      properties: 
        type: 
          default: Plane
        Origin: 
          allOf:
            - $ref: '#/definitions/SpecklePoint'
        Normal:
          allOf:
            - $ref: '#/definitions/SpeckleVector'
        Xdir:
          allOf:
            - $ref: '#/definitions/SpeckleVector'
        Ydir:
          allOf:
            - $ref: '#/definitions/SpeckleVector'
SpeckleLine: 
  allOf:
    - $ref: '#/definitions/SpeckleObject'
    - type: object
      properties:
        type: 
          default: Line 
        start: 
          allOf:
            - $ref: '#/definitions/SpecklePoint'
        end: 
          allOf:
            - $ref: '#/definitions/SpecklePoint'
SpeckleRectangle:
  allOf:
    - $ref: '#/definitions/SpeckleObject'
    - type: object
      properties:
        type:
          default: Rectangle
        A:
          allOf:
            - $ref: '#/definitions/SpecklePoint' 
        B:
          allOf:
            - $ref: '#/definitions/SpecklePoint' 
        C:
          allOf:
            - $ref: '#/definitions/SpecklePoint' 
        D:
          allOf:
            - $ref: '#/definitions/SpecklePoint' 
SpeckleCircle: 
  allOf:
    - $ref: '#/definitions/SpeckleObject'
    - type: object
      properties: 
        type:
          default: Circle
        radius:
          type: number
        center:
          allOf:
            - $ref: '#/definitions/SpecklePoint'
        normal:
          allOf:
            - $ref: '#/definitions/SpeckleVector'
SpeckleBox:
  allOf:
    - $ref: '#/definitions/SpeckleObject'
    - type: object
      properties: 
        type:
          default: Box
        basePlane:
          allOf:
            - $ref: '#/definitions/SpecklePlane'
        xSize:
          allOf:
            - $ref: '#/definitions/SpeckleInterval'
        ySize:
          allOf:
            - $ref: '#/definitions/SpeckleInterval'
        zSize:
          allOf:
            - $ref: '#/definitions/SpeckleInterval'
SpecklePolyline:
  allOf:
    - $ref: '#/definitions/SpeckleObject'
    - type: object
      properties: 
        type:
          default: Polyline
        value:
          type: array
          items: 
            type: number
SpeckleCurve:
  allOf: 
    - $ref: '#/definitions/SpeckleObject'
    - type: object
      properties:
        type:
          default: Curve
        base64:
          type: string
          description: See SpeckleBrep.
        provenance:
          type: string
          description: See SpeckleBrep.
        displayValue:
          allOf:
            - $ref: '#/definitions/SpecklePolyline'
SpeckleMesh:
  allOf:
    - $ref: '#/definitions/SpeckleObject'
    - type: object
      properties:
        type: 
          default: Mesh
        vertices:
          type: array
          items:
            type: number
        faces:
          type: array
          items:
            type: number
        colors:
          type: array
          items:
            type: number
SpeckleBrep:
  allOf: 
    - $ref: '#/definitions/SpeckleObject'
    - type: object
      properties: 
        type:
          default: Brep
        base64: 
          type: string
          description: A base64 encoded string of the raw byte array of the object. Do not worry base64 encoding making strings 1.5x bigger, gzip essentially neutralises this - both in transit and in the db.
        provenance:
          type: string
          description: A short prefix of where the base64 comes from. For example, Rhino objects get ON aka Open Nurbs. Later down the road this should be a strict enum.
        displayValue:
          allOf:
            - $ref: '#/definitions/SpeckleMesh'